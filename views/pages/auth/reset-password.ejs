<div class="auth-page">
  <div class="auth-container">
    <div class="auth-header">
      <h1>Reset Password</h1>
      <p>Enter the OTP sent to your email and your new password.</p>
    </div>

    <% if (locals.errors && errors.length > 0) { %>
      <% errors.forEach(function(error) { %>
        <div class="error-message">
          <p>❌ <%= error %></p>
        </div>
      <% }); %>
    <% } %>

    <form method="POST" action="/auth/reset-password" id="resetPasswordForm">
      <input type="hidden" name="email" value="<%= email %>" />
      <input type="hidden" name="token" value="<%= token %>" />

      <div class="form-group">
        <label for="otp" class="form-label">Enter 6-Digit OTP</label>
        <div class="otp-inputs">
          <input type="text" class="otp-input" maxlength="1" pattern="\d" required />
          <input type="text" class="otp-input" maxlength="1" pattern="\d" required />
          <input type="text" class="otp-input" maxlength="1" pattern="\d" required />
          <input type="text" class="otp-input" maxlength="1" pattern="\d" required />
          <input type="text" class="otp-input" maxlength="1" pattern="\d" required />
          <input type="text" class="otp-input" maxlength="1" pattern="\d" required />
        </div>
        <input type="hidden" id="otpValue" name="otp" required />
      </div>

      <div class="form-group">
        <label for="password" class="form-label">New Password</label>
        <div class="password-input-wrapper">
          <div class="input-with-icon">
            <span class="input-icon">🔒</span>
            <input
              type="password"
              id="password"
              name="password"
              class="form-input"
              placeholder="Enter new password"
              minlength="8"
              required
              autocomplete="new-password"
              style="padding-right: 3rem;"
            />
          </div>
          <button
            type="button"
            class="password-toggle"
            onclick="togglePasswordVisibility('password')"
          >
            👁️
          </button>
        </div>
        <div class="password-strength-indicator" id="passwordStrengthIndicator">
          <div class="strength-bar" id="strengthBar"></div>
          <span id="strengthLabel"></span>
        </div>
      </div>

      <div class="form-group">
        <label for="confirmPassword" class="form-label">Confirm New Password</label>
        <div class="password-input-wrapper">
          <div class="input-with-icon">
            <span class="input-icon">🔒</span>
            <input
              type="password"
              id="confirmPassword"
              name="confirmPassword"
              class="form-input"
              placeholder="Confirm new password"
              minlength="8"
              required
              autocomplete="new-password"
              style="padding-right: 3rem;"
            />
          </div>
          <button
            type="button"
            class="password-toggle"
            onclick="togglePasswordVisibility('confirmPassword')"
          >
            👁️
          </button>
        </div>
        <span id="passwordMatchError" class="form-error"></span>
      </div>

      <button type="submit" class="btn-primary">Reset Password</button>
    </form>

    <div class="auth-links">
      <p>Didn't receive the OTP? <a href="/auth/forgot-password">Request again</a></p>
      <p>Remember your password? <a href="/auth/login">Log In</a></p>
    </div>
  </div>
</div>

<script>
  // Initialize OTP inputs and password strength meter
  document.addEventListener('DOMContentLoaded', function() {
    initOtpInputs();
    if (typeof initPasswordStrength === 'function') {
      initPasswordStrength();
    }
  });
</script>
